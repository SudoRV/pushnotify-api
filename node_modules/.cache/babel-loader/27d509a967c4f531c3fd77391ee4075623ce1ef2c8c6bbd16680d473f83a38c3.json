{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import Navbar from\"../components/Navbar\";import Sidebar from\"../components/Sidebar\";import\"../styles/Login.scss\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AuthForm=()=>{const[username,setUsername]=useState(\"\");const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[message,setMessage]=useState(null);const[loading,setLoading]=useState(false);const[mode,setMode]=useState(\"login\");const urlParams=new URLSearchParams(window.location.search);const autoClose=urlParams.get(\"close\")===\"auto\";useEffect(()=>{// Check if the path is /signup or /login\nsetMode(window.location.pathname.includes(\"signup\")?\"signup\":\"login\");},[]);const handleSubmit=async e=>{e.preventDefault();setLoading(true);setMessage(null);const payload={type:\"login\",// \"signup\" or \"login\"\nemail,password,...(mode===\"signup\"&&{username})// Only add username in signup\n};try{console.log(payload);const response=await fetch(\"https://inlmqkmxchdb5df6t3gjdqzpqi0jrfmc.lambda-url.eu-north-1.on.aws/\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(payload)});const data=await response.json();console.log(data);if(data.success){setMessage({type:\"success\",text:`${mode===\"signup\"?\"Signup\":\"Login\"} successful!`});window.localStorage.setItem(\"creds\",JSON.stringify(data.user_data));if(data.t_data[\"transaction-id\"]){console.log(\"have tdata\");window.localStorage.setItem(\"t_data\",JSON.stringify(data.t_data));}setTimeout(()=>{if(autoClose){window.close();}else{window.history.back();}},2000);}else{if(data.message.includes(\"already exists\")){setMessage({type:\"error\",text:\"User Already Exists\"});}else{setMessage({type:\"error\",text:data.message});}}}catch(error){setMessage({type:\"error\",text:\"Something went wrong! \"+error});}setLoading(false);};const[isSidebarOpen,setSidebarOpen]=useState(false);return/*#__PURE__*/_jsxs(\"div\",{className:\"h100 flex fdc\",children:[/*#__PURE__*/_jsx(Navbar,{toggleSidebar:()=>setSidebarOpen(!isSidebarOpen)}),/*#__PURE__*/_jsx(Sidebar,{isOpen:isSidebarOpen,toggleSidebar:()=>setSidebarOpen(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"login h100 flex fdc aic jcc\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:mode===\"signup\"?\"Sign Up\":\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[mode===\"signup\"&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",value:username,onChange:e=>setUsername(e.target.value.trim()),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:email,onChange:e=>setEmail(e.target.value.trim()),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value.trim()),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?`${mode===\"signup\"?\"Signing up...\":\"Logging in...\"}`:mode===\"signup\"?\"Sign Up\":\"Login\"})]}),message&&/*#__PURE__*/_jsx(\"p\",{className:message.type,children:message.text}),/*#__PURE__*/_jsxs(\"p\",{children:[mode===\"signup\"?\"Already have an account?\":\"Don't have an account?\",\" \",/*#__PURE__*/_jsx(\"a\",{href:mode===\"signup\"?\"/login\":\"/signup\",children:mode===\"signup\"?\"Login\":\"Sign Up\"})]})]})})]});};export default AuthForm;","map":{"version":3,"names":["React","useState","useEffect","Navbar","Sidebar","jsx","_jsx","jsxs","_jsxs","AuthForm","username","setUsername","email","setEmail","password","setPassword","message","setMessage","loading","setLoading","mode","setMode","urlParams","URLSearchParams","window","location","search","autoClose","get","pathname","includes","handleSubmit","e","preventDefault","payload","type","console","log","response","fetch","method","headers","body","JSON","stringify","data","json","success","text","localStorage","setItem","user_data","t_data","setTimeout","close","history","back","error","isSidebarOpen","setSidebarOpen","className","children","toggleSidebar","isOpen","onSubmit","placeholder","value","onChange","target","trim","required","disabled","href"],"sources":["/data/data/com.termux/files/home/jWTFcm/clients/pushnotify-api/src/pages/Login.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Navbar from \"../components/Navbar\";\nimport Sidebar from \"../components/Sidebar\";\n\nimport \"../styles/Login.scss\";\n\nconst AuthForm = () => {\n  const [username, setUsername] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [message, setMessage] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [mode, setMode] = useState(\"login\");\n  const urlParams = new URLSearchParams(window.location.search);\n  const autoClose = urlParams.get(\"close\") === \"auto\";\n\n  useEffect(() => {   \n    // Check if the path is /signup or /login\n    setMode(window.location.pathname.includes(\"signup\") ? \"signup\" : \"login\");\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setMessage(null);\n\n    const payload = {\n      type: \"login\", // \"signup\" or \"login\"\n      email,\n      password,\n      ...(mode === \"signup\" && { username }), // Only add username in signup\n    };\n\n    try {\n      console.log(payload);\n      const response = await fetch(\"https://inlmqkmxchdb5df6t3gjdqzpqi0jrfmc.lambda-url.eu-north-1.on.aws/\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(payload),\n      });\n\n      const data = await response.json();\n\n      console.log(data)\n\n      if (data.success) {\n        setMessage({ type: \"success\", text: `${mode === \"signup\" ? \"Signup\" : \"Login\"} successful!` });                                      \n        window.localStorage.setItem(\"creds\",JSON.stringify(data.user_data));\n                         \n        if(data.t_data[\"transaction-id\"]){ \n            console.log(\"have tdata\")           \n            window.localStorage.setItem(\"t_data\",JSON.stringify(data.t_data));\n        }\n                                         \n        setTimeout(()=>{           \n            if(autoClose){\n               window.close();                              \n            }else{                               \n               window.history.back();                                             \n            }\n        },2000)\n                   \n      } else {\n        if (data.message.includes(\"already exists\")) {\n          setMessage({ type: \"error\", text: \"User Already Exists\" });\n        } else {\n          setMessage({ type: \"error\", text: data.message });\n        }\n      }\n    } catch (error) {\n      setMessage({ type: \"error\", text: \"Something went wrong! \" + error });\n    }\n\n    setLoading(false);\n  }; \n  \n  const [isSidebarOpen, setSidebarOpen] = useState(false);   \n\n  return (\n    <div className=\"h100 flex fdc\">\n    <Navbar toggleSidebar={() => setSidebarOpen(!isSidebarOpen)} />\n    <Sidebar isOpen={isSidebarOpen} toggleSidebar={() => setSidebarOpen(false)} />         \n    \n   <div className=\"login h100 flex fdc aic jcc\">\n    <div className=\"login-container\">       \n      <h2>{mode === \"signup\" ? \"Sign Up\" : \"Login\"}</h2>\n      <form onSubmit={handleSubmit}>\n        {mode === \"signup\" && (\n          <input\n            type=\"text\"\n            placeholder=\"Username\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value.trim())}\n            required\n          />\n        )}\n        <input\n          type=\"email\"\n          placeholder=\"Email\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value.trim())}\n          required\n        />\n        <input\n          type=\"password\"\n          placeholder=\"Password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value.trim())}\n          required\n        />\n        <button type=\"submit\" disabled={loading}>\n          {loading ? `${mode === \"signup\" ? \"Signing up...\" : \"Logging in...\"}` : mode === \"signup\" ? \"Sign Up\" : \"Login\"}\n        </button>\n      </form>\n      {message && <p className={message.type}>{message.text}</p>}\n      <p>\n        {mode === \"signup\" ? \"Already have an account?\" : \"Don't have an account?\"}{\" \"}\n        <a href={mode === \"signup\" ? \"/login\" : \"/signup\"}>\n          {mode === \"signup\" ? \"Login\" : \"Sign Up\"}\n        </a>\n      </p>\n   \n    </div>\n   </div>    \n        \n  </div>\n  );\n};\n\nexport default AuthForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}